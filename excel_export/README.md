# Экспорт расписания в Excel

Самостоятельный инструмент для выгрузки расписания группы или преподавателя
за целый семестр в формат `.xlsx`. Работает поверх основных модулей бота и
не влияет на текущую структуру.

## Быстрый старт

```bash
pip install -r requirements.txt

# Пример: выгрузить расписание группы ИС1-227-ОТ за осень текущего года
python -m excel_export.export_semester --query "ИС1-227-ОТ" --mode student
```

### Основные аргументы

| Аргумент | По умолчанию | Описание |
|----------|--------------|----------|
| `--query` | — | Название группы или преподавателя (обязательно). |
| `--mode` | `student` | `student` (группа) или `teacher` (преподаватель). |
| `--semester` | определяется автоматически | `autumn` (сентябрь–декабрь) или `spring` (январь–апрель). |
| `--year` | авто | Год семестра (например `2025`). |
| `--output` | `exports/` | Папка, куда будет сохранён Excel-файл. |
| `--send` | выключено | Отправить файл в Telegram. Требуются токен и chat_id. |

## Telegram-отправка

1. Скопируйте `config.example.py` → `config.py`.
2. Укажите `TELEGRAM_BOT_TOKEN` и `TELEGRAM_CHAT_ID`.
3. Запустите с флагом `--send`, либо передайте `--bot-token/--chat-id` явно.

```bash
python -m excel_export.export_semester \
  --query "ИС1-227-ОТ" \
  --send
```

## Формат Excel

- Отдельная книга для выбранной группы/преподавателя.
- Заголовок с названием семестра и сущности.
- Колонки: дата, день недели, № пары, время, предмет, преподаватель,
  аудитория, группы/подгруппа, комментарии.
- Автоматическое масштабирование ширины и фиксированная шапка.

## Примечания

- Семестры жёстко заданы: `autumn` — сентябрь-декабрь, `spring` — январь-апрель.
- Воскресенье пропускается.
- Для ускорения можно ограничить диапазон дат параметрами `--start` и `--end`.

