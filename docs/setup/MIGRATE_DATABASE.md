# Миграция базы данных со старого аккаунта Amvera на новый

## Шаг 1: Экспорт данных со старого аккаунта

### Вариант A: Через терминал Amvera (если есть доступ)

1. **Подключитесь к терминалу старого аккаунта Amvera**

2. **Запустите скрипт экспорта:**
   ```bash
   cd /app
   python export_database.py --export sql --output /data/users_export.sql
   ```

3. **Скачайте файл:**
   - Через панель Amvera: "Репозиторий → Data" → скачайте `users_export.sql`
   - Или через терминал: скопируйте файл на ваш компьютер

### Вариант B: Через панель Amvera (если нет доступа к терминалу)

1. **Откройте панель старого аккаунта Amvera**

2. **Перейдите в "Репозиторий → Data"**

3. **Скачайте файл `users.db`** (если он там есть)

4. **На вашем компьютере запустите:**
   ```bash
   # Скопируйте users.db в корень проекта
   python export_database.py --export sql --output users_export.sql
   ```

### Вариант C: Прямое копирование файла базы данных

1. **Через панель Amvera старого аккаунта:**
   - "Репозиторий → Data"
   - Скачайте файл `/data/users.db`

2. **Сохраните его локально**

## Шаг 2: Импорт данных в новый аккаунт

### Вариант A: Через SQL файл (рекомендуется)

1. **Загрузите SQL файл на новый аккаунт:**
   - Откройте панель нового аккаунта Amvera
   - "Репозиторий → Data"
   - Загрузите файл `users_export.sql`

2. **Подключитесь к терминалу нового аккаунта:**
   ```bash
   cd /app
   python export_database.py --import /data/users_export.sql
   ```

3. **Проверьте результат:**
   ```bash
   python export_database.py --export json --output /tmp/check.json
   # Посмотрите количество пользователей в файле
   ```

### Вариант B: Прямая замена файла базы данных

1. **Загрузите файл `users.db` на новый аккаунт:**
   - "Репозиторий → Data"
   - Загрузите файл в `/data/users.db`

2. **Проверьте права доступа:**
   ```bash
   chmod 644 /data/users.db
   ```

3. **Перезапустите бота**

## Шаг 3: Проверка

После импорта проверьте логи бота:

```
[INFO] Используется файл базы данных: /data/users.db
[INFO] ✅ Инициализировано X активных пользователей для проверки изменений расписания
[INFO] ✅ Восстановлено X задач ежедневных уведомлений
```

## Альтернативный способ: Через скрипт на сервере

Если у вас есть доступ к обоим аккаунтам через SSH:

1. **На старом аккаунте:**
   ```bash
   cd /app
   python export_database.py --export sql --output /tmp/users_export.sql
   ```

2. **Скопируйте файл на новый аккаунт** (через scp или другой способ)

3. **На новом аккаунте:**
   ```bash
   cd /app
   python export_database.py --import /tmp/users_export.sql
   ```

## Важно

- **Сделайте бэкап** текущей базы данных перед импортом
- **Проверьте формат** файла перед импортом
- **Убедитесь**, что путь к базе данных правильный (`/data/users.db`)

## Если нет доступа к старому аккаунту

Если у вас нет доступа к старому аккаунту Amvera, данные восстановить невозможно. Пользователям придется заново настраивать бота.

