# –û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –§–ª–∞–≥ `awaiting_broadcast` –Ω–µ –æ—á–∏—â–∞–ª—Å—è –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ —Ä–∞—Å—Å—ã–ª–∫–∏, —á—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–ª—É—á–∞–π–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ñ–ª–∞–≥–æ–≤ –æ–∂–∏–¥–∞–Ω–∏—è –≤–≤–æ–¥–∞ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (`admin_menu_callback`).

**–§–∞–π–ª:** `app/admin/handlers.py`

### 2. –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ –∫–Ω–æ–ø–æ–∫
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ö–Ω–æ–ø–∫–∞ "–°—Ç–∞—Ä—Ç" ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É `/start` (–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ "—Å—Ç–∞—Ä—Ç")
- –ö–Ω–æ–ø–∫–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–§–∞–π–ª:** `app/handlers.py` (—Å—Ç—Ä–æ–∫–∏ 844-851)

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç: –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

| –û–ø–µ—Ä–∞—Ü–∏—è | –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è | –û—Ü–µ–Ω–∫–∞ |
|----------|---------------|--------|
| `get_user` (—Å –∫–µ—à–µ–º) | 0.68 ms | üü¢ –û—Ç–ª–∏—á–Ω–æ |
| `save_user` | 13.98 ms | üü° –•–æ—Ä–æ—à–æ |
| `get_all_users` | 5.39 ms | üü¢ –û—Ç–ª–∏—á–Ω–æ |
| `log_activity` (batch) | 1.88 ms | üü¢ –û—Ç–ª–∏—á–Ω–æ |

### –¢–µ—Å—Ç: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–µ—à–∞

- **–ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å (–±–µ–∑ –∫–µ—à–∞):** 10.92 ms
- **–ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã (—Å –∫–µ—à–µ–º):** 0.00 ms (—Å—Ä–µ–¥–Ω–µ–µ)
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ:** 2632x üöÄ

### –¢–µ—Å—Ç: –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏

- **–ó–∞–ø–∏—Å—å/—á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞:** 17.03 ms (—Å—Ä–µ–¥–Ω–µ–µ) - üü° –•–æ—Ä–æ—à–æ

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
1. ‚úÖ –ö–µ—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ø–∞–º—è—Ç–∏ (TTLCache, 5 –º–∏–Ω—É—Ç TTL)
2. ‚úÖ –ë–∞—Ç—á-—Ä–µ–∂–∏–º –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
3. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î (–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö –≤ `start_command`)
4. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `lxml` –ø–∞—Ä—Å–µ—Ä–∞ –¥–ª—è HTML (–±—ã—Å—Ç—Ä–µ–µ —á–µ–º `html.parser`)

### üîÑ –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏):

1. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ë–î (aiosqlite)**
   - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: SQLite —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –Ω–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—ã—Å—Ç—Ä—ã–µ
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°—Ä–µ–¥–Ω–∏–π
   - –í—ã–≥–æ–¥–∞: –£–ª—É—á—à–∏—Ç –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è**
   - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∏–¥–µ—Ç –∫ API
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í—ã—Å–æ–∫–∏–π (–µ—Å–ª–∏ API –º–µ–¥–ª–µ–Ω–Ω—ã–π)
   - –í—ã–≥–æ–¥–∞: –°–Ω–∏–∑–∏—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ API –∏ —É—Å–∫–æ—Ä–∏—Ç –æ—Ç–≤–µ—Ç—ã

3. **Connection pooling –¥–ª—è SQLite**
   - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –û–¥–Ω–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—é
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ù–∏–∑–∫–∏–π (SQLite –∏ —Ç–∞–∫ –±—ã—Å—Ç—Ä—ã–π)
   - –í—ã–≥–æ–¥–∞: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è, —Ç–∞–∫ –∫–∞–∫ SQLite –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏

4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (jobs)**
   - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –î–≤–∞ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°—Ä–µ–¥–Ω–∏–π
   - –í—ã–≥–æ–¥–∞: –°–Ω–∏–∑–∏—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ API –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

## üìà –¢–µ–∫—É—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û—Ü–µ–Ω–∫–∞ –æ–±—â–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: üü¢ –û—Ç–ª–∏—á–Ω–æ

- **–û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î:** –ë—ã—Å—Ç—Ä—ã–µ (0.68-13.98 ms)
- **–ö–µ—à:** –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π (—É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 2632x)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ (–±–∞—Ç—á-—Ä–µ–∂–∏–º)

### –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –±–æ—Ç–∞:
- –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ ‚Üí –æ—Ç–≤–µ—Ç: **100-800ms** (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç Telegram API)
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è: **100-1500ms** (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç kis.vgltu.ru)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã `/start`: **~300-1500ms** (–≤–∫–ª—é—á–∞—è –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏)

## üõ†Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã

```bash
python test_performance.py
```

–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
- –°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –ë–î
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–µ—à–∞
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API)

## üìù –í—ã–≤–æ–¥—ã

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ë–î –æ—Ç–ª–∏—á–Ω–∞—è** - –∫–µ—à —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—ã—Å—Ç—Ä—ã–µ
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ** - –±–∞—Ç—á-—Ä–µ–∂–∏–º —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É
3. **–û—Å–Ω–æ–≤–Ω—ã–µ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞:**
   - –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ Telegram API (–Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è)
   - –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ kis.vgltu.ru (–Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è)
   - –û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ –≤ –ë–î (13.98 ms - –ø—Ä–∏–µ–º–ª–µ–º–æ)

4. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –¢–µ–∫—É—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–∞ –ø—Ä–∏ —Ä–æ—Å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (1000+).

